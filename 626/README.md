# 模拟月壤力学参数求解系统

## 项目简介

本项目基于 Mckyes 理论，通过竖板水平切割实验数据，求解模拟月壤的力学参数（内聚力 c、内摩擦角 φ、机-土摩擦角 δ）。项目使用 MATLAB 实现非线性最小二乘拟合，将理论计算值与实验测量值进行匹配，从而确定最优的力学参数。

## 理论背景

### Mckyes 理论

Mckyes 理论是用于描述土壤切割过程中力学行为的经典理论。在该理论中，水平阻力 T 可以表示为：

```
T = w × (γ × g × d² × N_γ + c × d × N_c + γ × v² × d × N_α)
```

其中：
- **w**: 竖板宽度 (m)
- **γ**: 模拟月壤密度 (kg/m³)
- **g**: 重力加速度 (m/s²)
- **d**: 入土深度 (m)
- **v**: 水平推进速度 (m/s)
- **c**: 内聚力 (Pa)
- **φ**: 内摩擦角 (rad)
- **δ**: 机-土摩擦角 (rad)

N_γ、N_c、N_α 是与摩擦角相关的无量纲系数，通过以下公式计算：

```
ρ = (π/4) - (φ/2)
E = cos(π/4 + δ) + sin(π/4 + δ) × cot(ρ + φ)
N_γ = 0.5 × cot(ρ) / E
N_c = (1 + cot(ρ) × cot(ρ + φ)) / E
N_α = (tan(ρ) + cot(ρ + φ)) / E
```

## 项目结构

```
project/
├── main_solve_mckyes_parameters.m      # 主脚本 - 使用 fsolve 求解
├── main_solve_mckyes_parameters_v2.m   # 主脚本 v2 - 使用 lsqnonlin 求解（推荐）
├── mckyes_T.m                          # Mckyes 理论水平阻力计算函数
├── equations_to_solve.m                # 方程组定义函数
├── plot_results.m                       # 结果可视化脚本
└── README.md                           # 本文件
```

## 文件说明

### 1. `main_solve_mckyes_parameters_v2.m` (推荐使用)
- **功能**: 主脚本文件，使用 `lsqnonlin` 求解器进行参数优化
- **优势**: 相比 `fsolve`，更适合处理实验数据拟合问题
- **输入**: 实验数据点、物理常数、初始猜测值、参数边界
- **输出**: 最优的力学参数 c、φ、δ，以及误差分析

### 2. `mckyes_T.m`
- **功能**: 根据给定的力学参数计算理论水平阻力 T
- **输入**: c, φ, δ, w, γ, g, d, v
- **输出**: 计算得到的水平阻力 T (N)

### 3. `equations_to_solve.m`
- **功能**: 为优化器提供目标函数
- **作用**: 计算理论值与实验值之间的残差，包含物理合理性约束

### 4. `plot_results.m`
- **功能**: 结果可视化
- **内容**: 
  - 实测数据点与理论曲线对比图
  - 求解参数的柱状图展示

## 使用方法

### 环境要求
- MATLAB R2016b 或更高版本
- Optimization Toolbox（用于 `lsqnonlin` 和 `fsolve` 函数）

### 运行步骤

1. **基础求解**（推荐）:
   ```matlab
   run('main_solve_mckyes_parameters_v2.m')
   ```

2. **备选求解方法**:
   ```matlab
   run('main_solve_mckyes_parameters.m')
   ```

3. **结果可视化**:
   ```matlab
   run('plot_results.m')
   ```

### 参数配置

在运行前，可能需要调整以下参数：

**物理常数**:
```matlab
w = 0.05;           % 竖板宽度 (m)
gamma = 1.64 * 1000; % 模拟月壤密度 (kg/m³)
g = 9.81;            % 重力加速度 (m/s²)
```

**实验数据**:
```matlab
data_points = [
    0.03, 0.001, mean([8.4, 8.5, 9.6]);    % d(m), v(m/s), T(N)
    0.04, 0.001, mean([24.1, 24.3, 27.9]);
    0.05, 0.001, mean([37.6, 47.1, 28.3]);
];
```

**优化参数**:
```matlab
c0 = 100;                    % 初始内聚力 (Pa)
phi0 = deg2rad(30);          % 初始内摩擦角 (rad)
delta0 = deg2rad(20);        % 初始机-土摩擦角 (rad)
lb = [0, deg2rad(10), deg2rad(5)];      % 参数下界
ub = [5000, deg2rad(60), deg2rad(45)];  % 参数上界
```

## 输出结果

程序运行成功后，将输出：

1. **最优力学参数**:
   - 内聚力 c (Pa 和 kPa)
   - 内摩擦角 φ (弧度和度)
   - 机-土摩擦角 δ (弧度和度)
   - 残差平方和

2. **验证表格**:
   - 比较实测 T 值与理论计算 T 值
   - 显示每组数据的相对误差

3. **可视化图表**:
   - T-d 关系曲线（实测点与理论曲线）
   - 求解参数的柱状图

## 技术特点

### 数值方法
- **非线性优化**: 使用最小二乘法进行参数拟合
- **边界约束**: 确保参数在物理合理范围内
- **稳定性处理**: 避免数值计算中的奇异情况

### 物理约束
- 内聚力 c ≥ 0
- 摩擦角 φ, δ ∈ (0°, 90°)
- 通常 δ < φ（机-土摩擦角小于内摩擦角）

### 数据处理
- 重复实验数据取平均值
- 多组实验数据同时拟合
- 误差分析和结果验证

## 注意事项

1. **数据质量**: 确保实验数据的准确性和一致性
2. **初始值**: 合理设置初始猜测值有助于提高收敛速度
3. **参数边界**: 根据材料特性设置合适的参数上下界
4. **模型适用**: Mckyes 理论适用于特定条件下的土壤切割问题

## 扩展功能

可以考虑的改进方向：
- 支持更多实验数据点
- 添加参数敏感性分析
- 实现参数不确定性评估
- 支持其他土壤力学理论（如 Werthmüller 理论）

## 参考文献

- McKyes, E. (1985). Soil cutting and tillage. Elsevier.
- 相关土壤力学和车辆地面力学文献

---

**开发者**: [您的姓名]  
**创建日期**: 2025年12月  
**版本**: 1.0